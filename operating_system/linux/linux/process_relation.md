## 进程关系

- 2021-12-11

### 伪终端

```
ps -l
```

```
F S   UID   PID  PPID  C PRI  NI ADDR SZ WCHAN  TTY          TIME CMD
4 S     0    31     0  0  80   0 -  2961 -      pts/2    00:00:00 bash
0 R     0   301    31  0  80   0 - 12406 -      pts/2    00:00:00 ps
```

进程31，是由`/bin/bash`文件启动的，同时该进程关联一个伪终端`pts/2`。也就是说进程31是关联了终端的进程，也称为控制进程。

### 进程组

进程组就是多个进程的集合，每个进程它都有所属的进程组，每个进程组都有一个组长。进程有自己的标识，称为进程id，进程组也有自己的标识，称为进程组id。

程序中，通过getpgid函数或者getpgrp函数获取指定进程id所属的进程组的id，通过setpgid函数设置指定进程id所属的进程组。

### 会话

会话就是进程组的集合，每个会话都有会话id。

程序中，通过getsid函数获取会话id，通过setsid函数设置会话。

当一个进程调用setsid函数时，会发生三件事：

- 该进程会变成会话首进程（session leader）。
- 该进程会变成进程组的组长。
- 该进程不会关联终端，就算父进程有终端也会断开。

一个会话可能关联一个终端，如果一个会话首进程关联了终端，此时它就是控制进程。

一个会话关联了一个终端后，它至少有一个前台进程组，其它都是后台进程组。

在终端输入特殊字符，如：中断键（ctrl+c）、暂停键（ctrl+z）、退出键（ctrl+\）。会产生中断信号，并往前台进程组里的所有进程发送，但是不会给后台进程组里的进程发送。

### 作业控制

作业控制就是在shell控制终端启动多个作业（子进程）。