## 操作系统

- 2021-11-09
- 18、操作系统-Operating Systems
- 20、文件和文件系统-Files and File Systems

### 操作系统

第一个操作系统，加强了程序的加载方式。以前的计算机一次只能输入一个程序，程序运行结束，需要人工输入下一个程序。在使用操作系统之后，一次可以输入多个程序，当运行完一个程序，会自动运行下一个程序。也叫批处理。

#### 设备驱动程序

为了让程序员更容易的编写程序，操作系统充当软件和硬件之间的媒介。更具体地说操作系统提供API来抽象硬件，叫设备驱动程序。程序员可以使用标准化机制和输入输出硬件交互。

#### 多任务处理

CPU和其它设备存在速度上的差异。当单线运行一个打印程序时，CPU调用打印机工作，在打印机工作的时间里，CPU就闲着了。

为了最大程度利用CPU，产生了任务调度。当一个打印程序进入打印流程时，CPU可以将这个任务标记位睡眠，转而去处理其他任务，当这个任务的打印流程完成后，CPU在将这个任务拉起来继续执行。

#### 内存分配

同时运行多个程序有个问题，每个程序都会占一些内存。当切换到另一个程序时，不能丢失数据。解决方法是：给每个程序分配专属内存块。

但是给每个程序分配的内存块的物理地址很复杂，为了隐藏这种复杂性，操作系统会把内存地址进行虚拟化。这叫虚拟内存，程序可以假定内存地址总是从0开始。

每个程序使用的内存隔离开来的另一个好处是，每个程序只能在自己的内存块中操作，不会影响别的程序的内存块。这叫内存保护。

#### 分时操作系统

分时操作系统不但处理多个程序，还要处理多个用户。每个用户只能用小部分处理器、内存等

#### UNIX

UNIX将操作系统分成两部分：第一部分是操作系统核心功能（内核），如：内存管理、多任务、输入输出处理。第二部分是一堆有用的工具（运行库），但它们不是内核的一部分。

### 文件和文件系统

#### 文件

文件的本质都是二进制编码，不同的文件类型，编码格式不同。

在正确读取数据之前，需要知道这些数据是什么。关于数据的数据叫元数据（meta data）。元数据存在文件开头，在实际数据前面，因此也叫文件头。

#### 目录文件

目录文件记录其他文件的信息，比如：文件名、扩展名、元数据、创建时间、修改时间、所有者、读写权限等。最重要的是目录文件还会记录文件的起始位置和文件长度。

#### 文件系统

文件系统专门管理文件。文件系统让我们不必在关心文件实际存储位置，让整理和访问文件更加方便。

##### 平面文件系统

所有文件都在同一个层次的叫平面文件系统。

平面层次系统有一个问题，文件都是首尾相连的，如果前面的文件增加了数据，会导致后面的文件被覆盖。现代计算机为了解决这个问题，会把空间划分成一块一块的。目录文件记录文件的位置的方式变成记录文件所在空间块的编号。

##### 分层文件系统

分层文件系统就是现在常用的文件夹套文件夹的形式。每个文件夹都有一个目录文件。

#### 移动文件

移动文件只需要修改目录文件中的数据。不需要移动实际存储空间的数据。

#### 删除文件

删除文件时只是把目录文件中对应的数据删掉了，并没有修改实际存储空间的数据。原先放置被删除文件数据的空间块会被标记为可用块。在这些空间块被新的数据覆盖之前，被删除文件的数据还在原处。

#### 碎片整理

如果不进行整理，大量的文件会以碎片的形式存储在各个地方。而磁盘巡道是需要时间的，所以这种情况会影响读取速度。现代计算机会把数据来回移动，排列成正确的顺序，方便读取。