### 08接口和抽象类的区别

并不是所有的面向对象编程语言都支持这两个语法概念，比如，C++这种编程语言只支持抽象类，不支持接口；而像Python这样的动态编程语言，既不支持抽象类，也不支持接口。

抽象类不允许被实例化，只能被继承。抽象类可以包含属性和方法。方法既可以包含代码实现，也可以不包含代码实现。不包含代码实现的方法叫作抽象方法。子类继承抽象类，必须实现抽象类中的所有抽象方法。

抽象类是为代码复用而生的。多个子类可以继承抽象类中定义的属性和方法，避免在子类中，重复编写相同的代码。

接口不能包含属性。接口只能声明方法，方法不能包含代码实现。类实现接口的时候，必须实现接口中声明的所有方法。

接口侧重于解耦。调用者只需要关注抽象的接口，不需要了解具体的实现，具体的实现代码对调用者透明。接口实现了约定和实现相分离，可以降低代码间的耦合性，提高代码的可扩展性。

如果我们要表示一种is-a的关系，并且是为了解决代码复用的问题，我们就用抽象类；如果我们要表示一种has-a关系，并且是为了解决抽象而非代码复用的问题，那我们就可以使用接口。

从类的继承层次上来看，抽象类是一种自下而上的设计思路，先有子类的代码重复，然后再抽象成上层的父类（也就是抽象类）。而接口正好相反，它是一种自上而下的设计思路。我们在编程的时候，一般都是先设计接口，再去考虑具体的实现。

### 09基于接口而非实现编程

我们理解基于接口而非实现编程这条原则的时候，千万不要一开始就与具体的编程语言挂钩，局限在编程语言的接口语法中。这条原则最早出现于1994年GoF的《设计模式》这本书，它先于很多编程语言而诞生，是一条比较抽象、泛化的设计思想。

从本质上来看，接口就是一组协议或者约定，是功能提供者提供给使用者的一个功能列表。基于接口而非实现编程这条原则中的接口，可以理解为编程语言中的接口或者抽象类。这条原则的另一个表述方式，是基于抽象而非实现编程。

越抽象、越顶层、越脱离具体某一实现的设计，越能提高代码的灵活性，越能应对未来的需求变化。好的代码设计，不仅能应对当下的需求，而且在将来需求发生变化的时候，仍然能够在不破坏原有代码设计的情况下灵活应对。而抽象就是提高代码扩展性、灵活性、可维护性最有效的手段之一。

解决上述问题的根本方法就是，在编写代码的时候，要遵从基于接口而非实现编程的原则，具体来讲，需要做到下面这3点：函数的命名不能暴露任何实现细节；封装具体的实现细节；为实现类定义抽象的接口。

软件开发中唯一不变的就是变化。在做软件开发的时候，一定要有抽象意识、封装意识、接口意识。在定义接口的时候，不要暴露任何实现细节。接口的定义只表明做什么，而不是怎么做。

做任何事情都要讲求一个度，过度使用这条原则，也会导致不必要的开发负担。这条原则的设计初衷是，将接口和实现相分离，封装不稳定的实现，暴露稳定的接口。上游系统面向接口而非实现编程，不依赖不稳定的实现细节，这样当实现发生变化的时候，上游系统的代码基本上不需要做改动，以此来降低代码间的耦合性，提高代码的扩展性。

越是不稳定的系统，我们越是要在代码的扩展性、维护性上下功夫。相反，如果某个系统特别稳定，在开发完之后，基本上不需要做维护，那我们就没有必要为其扩展性，投入不必要的开发时间。

### 10组合还是继承

继承是面向对象的四大特性之一，用来表示类之间的is-a关系，可以解决代码复用的问题。虽然继承有诸多作用，但继承层次过深、过复杂，也会影响到代码的可维护性。可以利用组合、接口、委托三个技术手段，一块来解决继承存在的问题。

尽管鼓励多用组合少用继承，但组合也并不是完美的，继承也并非一无是处。如果类之间的继承结构稳定，继承层次比较浅，继承关系不复杂，就可以大胆地使用继承。反之，系统越不稳定，继承层次很深，继承关系复杂，就尽量使用组合来替代继承。只要我们控制好它们的副作用、发挥它们各自的优势，在不同的场合下，恰当地选择使用继承还是组合，这才是我们所追求的境界。

除此之外，还有一些设计模式会固定使用继承或者组合。比如，装饰者模式、策略模式、组合模式等都使用了组合关系，而模板模式使用了继承关系。还有一些特殊的场景要求我们必须使用继承。如果你不能改变一个函数的入参类型，而入参又非接口（比如是个类的实例），为了支持多态，只能采用继承来实现。