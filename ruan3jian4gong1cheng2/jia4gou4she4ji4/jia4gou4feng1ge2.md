## 软件架构风格

- 2021-11-02

### 软件架构风格

软件架构风格是描述某一特定应用领域中系统组织方式的惯用模式。

架构风格定义一个词汇表和一组约束。词汇表中包含一些构件和连接件类型，约束指出系统如何将这些构件和连接件组合起来。

架构风格反映了领域中众多系统所共有的结构和语义特性。

### 基本架构风格

#### 数据流风格

面向数据流，按照顺序从前向后执行程序。

批处理序列：每个步骤都是独立的程序，前一个步骤完成后，后一个步骤才能开始，数据必须以整体的方式传递。

批处理序列的代表：windows的`.bat`批处理脚本，传统编译器。

管道过滤器：每个步骤都有输入和输出，前一个步骤的输出是后一个步骤的输入，数据不需要整体传递。其中，管道是连接件，过滤器是构件。

管道过滤器的代表：linux的管道。

#### 调用返回风格

主程序子程序：主程序和子程序都是构件，过程调用（交互机制）扮演连接件的角色。

面向对象：对象是构件。对象之间的联系方式扮演连接件的角色。

层次结构：许多构件组成一个层次结构，每层结构为上层提供服务，使用下一层的服务。层之间的交互协议扮演连接件的角色。

#### 独立构件风格

进程通信：独立的进程是构件，消息传递扮演连接件的角色。

事件驱动（隐式调用）：构件不直接调用一个过程，而是触发或广播一个或多个事件。构件中的过程在一个或多个事件中注册，当某个事件被触发时，系统自动调用在这个事件中注册的所有过程。

事件驱动的代表：程序语法高亮。

#### 虚拟机风格

解释器：通常包括一个完成解释工作的解释引擎、一个包含将被解释的代码的存储区、一个记录解释器引擎当前工作状态的数据结构，以及一个记录源代码被执行的进度的数据结构。具有解释器风格的软件中包含一个虚拟机，可以仿真硬件的执行过程和一些关键应用。

规则系统：包括规则集，规则解释器，规则/数据选择器和工作内存。规则系统风格一般用于人工智能（AI）和决策支持系统（DSS）中。

#### 仓库风格（数据共享风格）

仓库风格以数据为中心。

仓库风格的代表：现代编译器的集成开发环境，其数据中心为编程语言的语法树。

数据库系统：有两大类构件，一类是中央共享数据员，保存当前系统的数据状态，另一类是多个地理处理单元，处理单元对数据元素进行操作。

黑板系统：包括知识元、黑板和控制三部分。常用于语言识别，知识推理等场景。

超文本系统：构件以网状连接方式互相连接，用户可以任意跳转到相关构件。

#### 闭环控制风格（过程控制）

软件和硬件之间可以表示为一个反馈循环。发出命令并接收反馈，循环往复达到平衡。

闭环控制风格的代表：空调温度调节，汽车定速巡航。

#### C2风格

通过连接件绑定在一起的按照一组规则运作的并行构建网络。

系统中的构件和连接件都有一个顶部和一个底部。构件的顶部应连接到连接件的底部，构件的底部应连接到某连接件的顶部，构件与构件之间的连接是不允许的。

一个连接件可以和任意数目的其他构件和连接件连接。

### 层次结构风格

#### 两层C/S架构

两层C/S架构又称为胖客户端架构。客户端和服务器都有处理功能。表示层和一部分业务逻辑位于客户端，数据层和一部分业务逻辑位于服务器。

缺点是：

- 1、由于客户端有一部分业务逻辑，导致软件维护和升级困难。
- 2、数据层位于服务器，导致服务器又要负责数据又要负责一部分业务，服务器压力大。
- 3、两端业务逻辑之间无法有效的进行隔离，安全性不高。

#### 三层C/S架构

两层C/S架构又称为瘦客户端架构。表示层、功能层和数据层相互独立，表示层和数据层相对简单，业务逻辑集中于功能层。

优点是：

- 1、相对于两层C/S架构，三层C/S架构整体系统逻辑结构更清晰，可以灵活地为不同的逻辑层次选用合适的平台和系统，能提高系统的可维护性和可扩展性。
- 2、功能层有效的隔离了表示层和数据层，可以提供有效的安全控制。

三层C/S架构设计的关键在于各层之间的通信效率。

#### 三层B/S架构

三层B/S架构又称为0客户端架构。是将三层C/S架构的客户端变成浏览器，将应用服务器换成web服务器。

优点是：没有客户端。

缺点是：

1、没有客户端，处理能力依赖浏览器，交互性弱。
2、整体性能低于C/S架构。
3、安全性难以控制。

#### 混合架构

内外有别模型：内部使用C/S，外部使用B/S。
查改有别模型：查询使用B/S，修改使用C/S。

缺点是：实现困难，而且成本高。

#### 富互联网应用

富互联网应用（RIA）结合了C/S架构性能高，交互性强的优点与B/S架构异传播的优点，简化并改进了B/S架构的用户交互。

数据能被缓存在客户端，必要的插件可以借助网络缓存在本地，从而实现一个比浏览器更快地响应速度。

典型的富互联网应用：微信小程序。